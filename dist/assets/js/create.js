"use strict";!function(){var e=function(){function e(){l.clearRect(0,0,u.width,u.height),u.width=i,u.height=c}function t(){l.drawImage(h,0,0,i,c)}function n(){var e=g/1.7,t=37*e/320,n=g/2-e/2;l.drawImage(m,n,c-40,e,t)}var i=g,c=h.height*i/h.width;e(),t(),n()},t=function(){e();var t=f.right.x-f.left.x+40;l.drawImage(d,f.left.x,f.left.y-t,t,t)},n=function(e){l.fillStyle="#29a2ef",l.fillRect(e.x-10,e.y-10,20,20)},i=function(e){f.left=e,document.querySelector(".instruction-1").classList.remove("highlight"),document.querySelector(".instruction-2").classList.add("highlight")},c=function(e){f.right=e,document.querySelector(".instruction-2").classList.remove("highlight"),document.querySelector(".instruction-3").classList.add("highlight")},o=function(e){switch(e){case"left":f.left.x--,f.right.x--;break;case"right":f.left.x++,f.right.x++;break;case"down":f.left.y++,f.right.y++;break;case"up":f.left.y--,f.right.y--}t()},r=function(){var e=document.getElementById("canvas"),t=e.toDataURL("image/png");sessionStorage.setItem("bluebeanieme",t),window.location.href="finish.html"},a=function(){y=0,e(),document.querySelector(".instruction-1").classList.add("highlight"),document.querySelector(".instruction-2").classList.remove("highlight"),document.querySelector(".instruction-3").classList.remove("highlight")},s=function(e){y++,3===y&&(y=1);var o={x:e.offsetX,y:e.offsetY};switch(n(o),y){case 1:i(o);break;case 2:c(o),setTimeout(function(){t()},500)}},u=document.getElementById("canvas"),l=u.getContext("2d"),d=document.getElementById("beanie"),m=document.getElementById("logo"),h=document.getElementById("image");h.setAttribute("crossOrigin","anonymous"),h.src=window.location.href.split("?img=")[1];var g=400,f={left:{},right:{}},y=0;setTimeout(function(){e()},1e3),u.addEventListener("click",s);var v=Array.from(document.querySelectorAll(".btn-move-beanie"));v.forEach(function(e){e.addEventListener("click",function(e){o(e.target.dataset.direction)})}),document.getElementById("export").addEventListener("click",r),document.getElementById("reset").addEventListener("click",a),document.addEventListener("keyup",function(e){if(2!==y)return!1;switch(e.preventDefault(),e.keyCode){case 39:o("right");break;case 37:o("left");break;case 38:o("up");break;case 40:o("down")}})}();