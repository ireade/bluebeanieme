"use strict";var drawImage=function(){function e(){ctx.clearRect(0,0,canvas.width,canvas.height),canvas.width=n,canvas.height=a}function t(){ctx.drawImage(image,0,0,n,a)}function i(){var e=IMAGE_WIDTH/1.7,t=37*e/320,i=IMAGE_WIDTH/2-e/2;ctx.drawImage(logo,i,a-40,e,t)}var n=IMAGE_WIDTH,a=image.height*n/image.width;e(),t(),i()},drawBeanie=function(){drawImage();var e=coordinates.right.x-coordinates.left.x+40;ctx.drawImage(beanie,coordinates.left.x,coordinates.left.y-e,e,e)},addRect=function(e){ctx.fillStyle="#29a2ef",ctx.fillRect(e.x-10,e.y-10,20,20)},setLeftCoord=function(e){coordinates.left=e,document.querySelector(".instruction-1").classList.remove("highlight"),document.querySelector(".instruction-2").classList.add("highlight")},setRightCoord=function(e){coordinates.right=e,document.querySelector(".instruction-2").classList.remove("highlight"),document.querySelector(".instruction-3").classList.add("highlight")},moveBeanie=function(e){switch(e){case"left":coordinates.left.x--,coordinates.right.x--;break;case"right":coordinates.left.x++,coordinates.right.x++;break;case"down":coordinates.left.y++,coordinates.right.y++;break;case"up":coordinates.left.y--,coordinates.right.y--}drawBeanie()},exportImage=function(){var e=document.getElementById("canvas"),t=e.toDataURL("image/png");sessionStorage.setItem("bluebeanieme",t),window.location.href="finish.html"},resetCanvas=function(){numberOfTimesClicked=0,drawImage(),document.querySelector(".instruction-1").classList.add("highlight"),document.querySelector(".instruction-2").classList.remove("highlight"),document.querySelector(".instruction-3").classList.remove("highlight")},onCanvasClick=function(e){3===++numberOfTimesClicked&&(numberOfTimesClicked=1);var t={x:e.offsetX,y:e.offsetY};switch(addRect(t),numberOfTimesClicked){case 1:setLeftCoord(t);break;case 2:setRightCoord(t),setTimeout(function(){drawBeanie()},500)}},canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),beanie=document.getElementById("beanie"),logo=document.getElementById("logo"),image=document.getElementById("image");image.setAttribute("crossOrigin","anonymous"),image.src=window.location.href.split("?img=")[1];var IMAGE_WIDTH=400,coordinates={left:{},right:{}},numberOfTimesClicked=0;setTimeout(function(){drawImage()},1e3),canvas.addEventListener("click",onCanvasClick);var moveBeanieButtons=Array.from(document.querySelectorAll(".btn-move-beanie"));moveBeanieButtons.forEach(function(e){e.addEventListener("click",function(e){moveBeanie(e.target.dataset.direction)})}),document.getElementById("export").addEventListener("click",exportImage),document.getElementById("reset").addEventListener("click",resetCanvas),document.addEventListener("keyup",function(e){if(2!==numberOfTimesClicked)return!1;switch(e.preventDefault(),e.keyCode){case 39:moveBeanie("right");break;case 37:moveBeanie("left");break;case 38:moveBeanie("up");break;case 40:moveBeanie("down")}});